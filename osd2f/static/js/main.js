window.file_upload=(()=>{"use strict";var e={874:(e,t,n)=>{function r(e){return new Promise((t=>setTimeout(t,e)))}n.r(t),n.d(t,{fileLoadController:()=>i,sleep:()=>r});const o=function(e,t,n){let r,l={},i=e.map((e=>e.split(".").shift(1)));for(r of Object.keys(t)){if(0==i.filter((e=>e==r)).length)continue;let s=[n,r].filter((e=>void 0!==e)).join("."),a=t[r],c=e.filter((e=>e.startsWith(r))).map((e=>e.substring(r.length+1,e.length)));Array.isArray(a)?l[s]=a.map((e=>o(c,e))):"object"!=typeof a||null==a?l[s]=a:l=Object.assign(l,o(c,a,r))}return l},l=function(e,t,n,r){return null!=r?l(e,t[r],n):Array.isArray(t)&&0==e.length?[{entries:t}]:t.map((t=>o(e,t)))},i=async function(e,t,n,o){var i;let s;document.getElementById("processing").classList.remove("invisible"),i=Object.fromEntries(n.map((e=>{let n;for(n of Object.keys(t.files))if(RegExp(n).exec(e.name))return[e.name,n];return[]}))),Object.keys(i).map((e=>{"undefined"===e&&delete i[e]})),s=n.filter((e=>void 0!==i[e.name]));let a,c=[];for(s.map((async n=>{let o,s;if(null!=n.text)o=await n.text();else{let e=!1;n.readData(((t,n)=>{let r;r=new TextDecoder,o=r.decode(t),console.log(n),e=!0}));let t=1e4;for(;!e&&t>0;)await r(100),t-=100}s=new Object,s.filename=n.name,s.submission_id=e;try{s.entries=l(t.files[i[n.name]].accepted_fields,JSON.parse(o),null,t.files[i[n.name]].in_key),c.push(s)}catch(e){console.log("Invalid JSON file:",n.name),console.log(e),c.push(!1)}})),a=document.getElementById("progress-bar");c.length<s.length;){let e;e=c.length/s.length*100,e!==a.value&&(a.value=e),await r(500)}c=c.filter((e=>e)),a.value=100,fetch("/anonymize",{method:"POST",mode:"same-origin",credentials:"same-origin",headers:{"Content-Type":"application/json"},body:JSON.stringify(c)}).then((e=>(document.getElementById("processing").classList.add("invisible"),e.json()))).then((e=>{o(e)})).catch((e=>{console.log("Error",e)}))}}},t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={exports:{}};return e[r](o,o.exports,n),o.exports}return n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n(874)})();