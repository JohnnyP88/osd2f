<!DOCTYPE html>

<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="">
  <meta name="author" content="">

  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css"
    integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">

  <style>
    #drop-area {
      border: 2px dashed #ccc;
      border-radius: 20px;
      width: 480px;
      margin: 100px auto;
      padding: 20px;
    }

    #drop-area.highlight {
      border-color: cornflowerblue;
    }

    #progress-bar {
      width: 100%;
      height: 15px;

    }

    .colClass {
      word-wrap: break-word;
      max-width: 500px;
    }
  </style>
</head>

<body>

  <header>
    <div class="navbar navbar-dark shadow-sm navbar-expand-lg bg-dark fixed-top">
      <a class="navbar-brand" href="/">Digitale Voetsporen Project</a>

    </div>
  </header>



  <div class="container-fluid min-vh-100">
    <div class="row mb-0 pb-0">
      <div id="drop-area" class="col-xl-5 col-lg-6 col-md-8 col-sm-10 p-6 mb-1">
        <h3 class="text-center"> Selecteer bestand(en) om te Doneren </h3>
        <progress id="progress-bar" max=100 value=0></progress>
        <form class="my-form">
          <p>Upload het zipbestand met het bestandsdialoogvenster of door het zipbestand of de uitgepakte map te slepen
            en neer te zetten op
            het gestippelde gebied</p>
          <input type="file" id="fileElem">
          <label class="button" for="fileElem"></label>
        </form>

      </div>
    </div>
    <div class="row justify-content-center">
      <button type="button" class="btn btn-primary instrBtn mr-3" data-toggle="modal"
        data-target=".bd-instr-modal-lg">Instructies</button>
      <button type="button" class="btn btn-primary faqBtn mr-3" data-toggle="modal"
        data-target=".bd-faq-modal-lg">Veelgestelde Vragen</button>
      <button type="button" class="btn btn-primary helpBtn" data-toggle="modal"
        data-target=".bd-help-modal-lg">Hulp</button>
    </div>

    <div class="row justify-content-center invisible" id="thankyou">
      <h1>Dank u voor uw donatie!</h1>
    </div>

    <div class="row justify-content-center p-4">
      <div id="visualization">

        <donation-container v-bind:donations="donations">
        </donation-container>
      </div>
    </div>



    <div id="processing" class="invisible">
      <div class="row p-2 justify-content-center">
        <h2 class="text-center">Verwerking....</h2>
      </div>
      <div class="row p-2 justify-content-center">
        <div class="spinner-border text-primary" role="status">
          <span class="sr-only">Laden...</span>
        </div>
      </div>
    </div>


  </div>
  <footer>
    <div class="bg-dark m-0 pt-2 pb-2 text-center text-white text-bold">
      <p style="font-size: x-small;" class="m-0">Neem contact met ons op: digitale-voetsporen.fsw@vu.nl</p>
    </div>
  </footer>

  <!---------------------------------------Modal for instructions--------------------------------->
  <div class="modal fade bd-instr-modal-lg" tabindex="-1" role="dialog" id="instrModal">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
        </div>
      </div>
    </div>
  </div>
  <!-------------------------------------Modal for FAQ--------------------------------------------->
  <div class="modal fade bd-faq-modal-lg" tabindex="-1" role="dialog" id="faqModal">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
        </div>
      </div>
    </div>
  </div>
  <!-------------------------------------Modal for Help-------------------------------------------->
  <div class="modal fade bd-help-modal-lg" tabindex="-1" role="dialog" id="helpModal">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
        </div>
      </div>
    </div>
  </div>

  <script src="/static/js/main.js"></script>
  <script>
    let settings = {{ settings| tojson | safe }};
    let sid = {{ sid| tojson | safe}};


    let dropArea = document.getElementById("drop-area");

    ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
      dropArea.addEventListener(eventName, preventDefaults, false)
    })

    function preventDefaults(e) {
      e.preventDefault()
      e.stopPropagation()
    }

    ['dragenter', 'dragover'].forEach(eventName => {
      dropArea.addEventListener(eventName, highlight, false)
    });

    ['dragleave', 'drop'].forEach(eventName => {
      dropArea.addEventListener(eventName, unhighlight, false)
    })

    function highlight(e) {
      dropArea.classList.add('highlight')
    }

    function unhighlight(e) {
      dropArea.classList.remove('highlight')
    }



    // track whether the donation has been completed for the prevent close dialogue
    let noDonationYet = true

    // prevent accidentally leaving before donating
    window.onbeforeunload = confirmExit;
    function confirmExit() {
      if (noDonationYet) {
        return "You haven't donated yet, are you sure you want to leave?";
      }
    }

  </script>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"
    integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-ho+j7jyWK8fNQe+A12Hb8AhRq26LrZ/JpcUGGOn+Y7RsweNrtN/tE3MoK7ZeZDyx"
    crossorigin="anonymous"></script>

  <script>
    $('.instrBtn').on('click', function () {
      $('.modal-body').load('instructions', function () {
        $('#instrModal').modal({ show: true });
      });
    });
  </script>
  <script>
    $('.faqBtn').on('click', function () {
      $('.modal-body').load('faq', function () {
        $('#faqModal').modal({ show: true });
      });
    });
  </script>
  <script>
    $('.helpBtn').on('click', function () {
      $('.modal-body').load('help', function () {
        $('#helpModal').modal({ show: true });
      });
    });
  </script>
</body>

</html>